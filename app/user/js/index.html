<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <link rel="stylesheet" type="text/css" href="main.css">

    <script src="./node_modules/web3/dist/web3.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="./utils.js"></script>
    <script src="./contract.js"></script>
    <script src="./eth_browser_js/ethereumjs-tx-1.3.3.min.js"></script>
    <script src="./eth_browser_js/keythereum.js"></script> 

</head>
<body>
    <div class="container">

        <h1>Deposit SBTC</h1>

        <label for="account" class="col-lg-2 control-label">From Account</label>
        <input id="key_path" type="file"/>

        <label for="password" class="col-lg-2 control-label">Password</label>
        <input id="pwd" type="any" value = "puneet"/>

        <label for="name" class="col-lg-2 control-label">SBTC</label>
        <input id="sbtc" type="any" value="0.00000001">

        <label for="name" class="col-lg-2 control-label">Destination address</label>
        <input id="dest" type="any" value="0x9d465C631F1D8E47B6113Ab204a9410183fcCE05">

        <label for="status" class="col-lg-2 control-label">Status:</label>

        <button id="button">Deposit on RSK</button>

    </div>

    <div style="display:none;" id="key_contents"></div>   

<script>
    get_account_key("key_path", "key_contents");
    var web3_eth = init_web3("http://stride.ddns.net:8545"); 
    var web3_rsk = init_web3("http://stride.ddns.net:4444"); 
    contract_rsk = init_rsk_contract(web3_rsk);
    contract_eth = init_eth_contract(web3_eth);
   
    $("#button").click(function() {
        key_contents = document.getElementById("key_contents").value;
        console.log(key_contents);
        password = document.getElementById("pwd").value;
        dest_addr = document.getElementById("dest").value;
        sbtc_amount = document.getElementById("sbtc").value;
        if (key_contents == null | password == null) {
            console.log("Fill in all fields properly");
            return;
        }    

        deposit_sbtc(key_contents, password, sbtc_amount, dest_addr, 
                     contract_rsk, web3_rsk);

        /* TODO: Wait for n confirmations */
 
        /* TODO: Transfer EBTC to user on Ethereum chain */

    
    });

</script>
</body>
</html>
